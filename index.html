<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Iris93 • Personalised Gifts</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    :root{ --brand:#6b46c1; --brand-2:#7c3aed; --accent:#f59e0b; }
    .brand-gradient{ background: linear-gradient(135deg, var(--brand), var(--brand-2)); }
    .tab-btn[aria-selected="true"]{ color:#fff; background:var(--brand); }
    .tab-btn:hover{ background:rgba(123,97,255,.08); }
    .shadow-soft{ box-shadow:0 10px 30px rgba(17,24,39,.12); }
    .rounded-2xl iframe{ border-radius:1rem; overflow:hidden; }
    .filter-demo img:hover{ filter: brightness(1.1) saturate(1.05); transition: filter .2s ease; }
    [data-badge]{ background:#faf5ff; border-color:#e9d8fd; }
    .swatch{ display:inline-block; width:14px; height:14px; border-radius:9999px; border:1px solid #e5e7eb; margin-right:6px; vertical-align:middle;}
    .th-sortable{ cursor:pointer; }
    .th-sortable:after{ content:" ↕"; opacity:.4; }
    /* Facebook Page Plugin responsive */
    .fb-page, .fb-page iframe{ width:100% !important; }
    /* Modal gallery */
    .thumb{ width:60px; height:60px; border-radius:.5rem; object-fit:cover; border:1px solid #e5e7eb; cursor:pointer; }
    .thumb.active{ outline:3px solid #a78bfa; }
    .carousel-btn{ position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,.45); color:#fff; border:none; width:40px; height:40px; border-radius:9999px; display:flex; align-items:center; justify-content:center; }
    .carousel-btn.left{ left:10px; } .carousel-btn.right{ right:10px; }
  </style>
</head>
<body class="min-h-screen bg-gray-50 text-gray-800">

<!-- ===== NAV ===== -->
<header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b">
  <nav class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16">
    <a href="#" class="flex items-center gap-3">
      <img src="logo.png" alt="Iris93 Logo" class="h-10 w-10 object-contain rounded-lg border">
      <span class="text-xl font-semibold tracking-tight">Iris93 • Personalised Gifts</span>
    </a>
    <div class="flex items-center gap-2">
      <a href="https://www.facebook.com/profile.php?id=100077254045255" target="_blank" rel="noopener" class="hidden sm:inline-flex items-center px-3 py-2 rounded-lg border hover:bg-gray-50">
        <i class="fa-brands fa-facebook mr-2"></i> Follow
      </a>
      <a href="https://www.facebook.com/profile.php?id=100077254045255" target="_blank" rel="noopener" class="inline-flex items-center gap-2 px-4 py-2 rounded-xl text-white" style="background: var(--brand);">
        <i class="fa-regular fa-message"></i><span>Message us</span>
      </a>
      <button id="cartBtn" class="relative inline-flex items-center gap-2 px-4 py-2 rounded-xl text-white" style="background: var(--brand);">
        <i class="fa-solid fa-cart-shopping"></i><span>Cart</span>
        <span id="cartCount" class="absolute -top-2 -right-2 text-xs bg-rose-600 text-white rounded-full px-1.5 py-0.5">0</span>
      </button>
    </div>
  </nav>
</header>

<!-- ===== HERO ===== -->
<section class="brand-gradient text-white">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-10 lg:py-16 grid gap-8 items-center">
    <div>
      <h1 class="text-4xl lg:text-5xl font-extrabold leading-tight">
        Make it <span class="text-amber-200">personal</span>. Make it <span class="underline decoration-amber-300">memorable</span>.
      </h1>
      <p class="mt-4 text-white/90 max-w-2xl">All products, prices and images are pulled from your curated content.</p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href="#collections" class="inline-flex items-center gap-2 bg-white text-gray-800 px-4 py-2 rounded-xl shadow-soft">
          <i class="fa-solid fa-gift"></i> Browse Collections
        </a>
        <a href="https://www.facebook.com/profile.php?id=100077254045255" target="_blank" rel="noopener"
           class="inline-flex items-center gap-2 border border-white/30 text-white px-4 py-2 rounded-xl hover:bg-white/10">
          <i class="fa-regular fa-message"></i> Message us
        </a>
      </div>
    </div>
  </div>
</section>

<!-- ===== SOCIAL EMBEDS (with FB fallback) ===== -->
<section class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 mt-8">
  <div class="grid lg:grid-cols-2 gap-6 items-start">
    <!-- Facebook -->
    <div class="bg-white rounded-2xl p-4 shadow-soft border">
      <h3 class="text-xl font-semibold mb-2">Facebook</h3>

      <!-- Fallback (hidden initially) -->
      <div id="fb-fallback" class="hidden">
        <div class="rounded-xl border p-4 bg-gray-50">
          <p class="text-sm text-gray-700">
            Your browser is blocking the Facebook embed. You can still view our latest posts directly on Facebook.
          </p>
          <a href="https://www.facebook.com/profile.php?id=100077254045255"
             target="_blank" rel="noopener"
             class="mt-3 inline-flex items-center gap-2 px-4 py-2 rounded-xl text-white"
             style="background: var(--brand);">
            <i class="fa-brands fa-facebook"></i> Open on Facebook
          </a>
        </div>
      </div>

      <!-- Official Page Plugin -->
      <div id="fb-wrapper">
        <div class="fb-page"
             data-href="https://www.facebook.com/profile.php?id=100077254045255"
             data-tabs="timeline"
             data-width="500"
             data-height="650"
             data-small-header="false"
             data-adapt-container-width="true"
             data-hide-cover="false"
             data-show-facepile="true">
          <blockquote cite="https://www.facebook.com/profile.php?id=100077254045255"
                      class="fb-xfbml-parse-ignore">
            <a href="https://www.facebook.com/profile.php?id=100077254045255">Iris93</a>
          </blockquote>
        </div>
      </div>
    </div>

    <!-- YouTube -->
    <div class="bg-white rounded-2xl p-4 shadow-soft border">
      <h3 class="text-xl font-semibold mb-2">YouTube</h3>
      <div class="aspect-video rounded-2xl overflow-hidden">
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/9TF9BZJgF5g?list=RD9TF9BZJgF5g&start_radio=1&rel=0&modestbranding=1" title="Playlist ambience" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
      </div>
    </div>
  </div>
</section>

<!-- ===== TABS ===== -->
<section class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 mt-10">
  <div class="flex flex-wrap gap-2" role="tablist" aria-label="Shop tabs">
    <button class="tab-btn px-4 py-2 rounded-xl border" role="tab" aria-selected="true" data-tab="collections" id="collections">Collections</button>
    <button class="tab-btn px-4 py-2 rounded-xl border" role="tab" aria-selected="false" data-tab="filters">Filters</button>
    <button class="tab-btn px-4 py-2 rounded-xl border" role="tab" aria-selected="false" data-tab="table" id="table">HTML Table</button>
  </div>

  <div class="mt-6 space-y-8">

    <!-- ===== COLLECTIONS ===== -->
    <div class="tab-panel" data-panel="collections">
      <div id="cardsGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 filter-demo">

        <!-- Cards (one main image; modal will show gallery if -2..-8.jpg exist) -->
        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="flowers" data-product='{"id":"funeral-flowers","title":"Funeral flowers","price":65,"img":"funeral-flowers-1.jpg","desc":"Can be made for any family member or friend, and it can be made with soap roses, or natural flowers. Flexible on colour schemes.","category":"flowers"}'>
          <img class="h-48 w-full object-cover" src="funeral-flowers-1.jpg" alt="Funeral flowers">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Funeral flowers</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Flowers</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Can be made with soap or natural flowers; colour flexible.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£65</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"easter-basket","title":"Easter basket","price":15,"img":"easter-basket-1.jpg","desc":"Can create on request Christmas baskets, or other type of baskets(as required).","category":"other"}'>
          <img class="h-48 w-full object-cover" src="easter-basket-1.jpg" alt="Easter basket">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Easter basket</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Request any theme or season.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£15</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="wall-art" data-product='{"id":"mother-s-day-wall-art","title":"Mother’s Day Wall art","price":10,"img":"mother-s-day-wall-art-1.jpg","desc":"Can be personalised and tweaked for any special occasion, and any special recipient.","category":"wall-art"}'>
          <img class="h-48 w-full object-cover" src="mother-s-day-wall-art-1.jpg" alt="Mother’s Day Wall art">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Mother’s Day Wall art</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Wall-Art</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Designed to order.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£10</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"international-women-s-day","title":"International Women’s Day","price":10,"img":"international-women-s-day-1.jpg","desc":"Can be personalised and tweaked for any special recipient.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="international-women-s-day-1.jpg" alt="International Women’s Day">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">International Women’s Day</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Any style, language or name.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£10</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"mother-s-day-keyrings","title":"Mother’s Day keyrings","price":1.5,"img":"mother-s-day-keyrings-1.jpg","desc":"Can be done for other occasions, like Father’s Day, Remembrance Day, Easter, Xmas, etc.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="mother-s-day-keyrings-1.jpg" alt="Mother’s Day keyrings">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Mother’s Day keyrings</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Bulk discounts available.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£1.5</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"personalised-metal-water-bottles","title":"Personalised metal water bottles","price":13,"img":"personalised-metal-water-bottles-1.jpg","desc":"Personalised to order.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="personalised-metal-water-bottles-1.jpg" alt="Personalised metal water bottles">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Personalised metal water bottles</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Great for school or gym.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£13</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"martis-martisor","title":"Martis/Martisor","price":2,"img":"martis-martisor-1.jpg","desc":"Personalised to order.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="martis-martisor-1.jpg" alt="Martis/Martisor">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Martis/Martisor</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Traditional spring charm.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£2</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"martisor-and","title":"Martisor  and","price":1,"img":"martisor-and-1.jpg","desc":"Personalised to order.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="martisor-and-1.jpg" alt="Martisor and">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Martisor  and</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Custom colours & charms.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£1</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="sweets" data-product='{"id":"sweet-treats-boxes","title":"Sweet treats boxes","price":3,"img":"sweet-treats-boxes-1.jpg","desc":"Can be personalised for any occasion and any recipient.","category":"sweets"}'>
          <img class="h-48 w-full object-cover" src="sweet-treats-boxes-1.jpg" alt="Sweet treats boxes">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Sweet treats boxes</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Sweets</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Great party favours.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£3</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"soap-roses-boxes","title":"Soap roses boxes","price":11,"img":"soap-roses-boxes-1.jpg","desc":"Personalised to order.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="soap-roses-boxes-1.jpg" alt="Soap roses boxes">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Soap roses boxes</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Long-lasting, gift-ready.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£11</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="flowers" data-product='{"id":"soap-flowers-bouquet","title":"Soap flowers bouquet","price":15,"img":"soap-flowers-bouquet-1.jpg","desc":"Personalised to order.","category":"flowers"}'>
          <img class="h-48 w-full object-cover" src="soap-flowers-bouquet-1.jpg" alt="Soap flowers bouquet">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Soap flowers bouquet</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Flowers</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Custom palette & size.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£15</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="mugs" data-product='{"id":"coffee-mugs-personalised","title":"Coffee mugs personalised","price":8,"img":"coffee-mugs-personalised-1.jpg","desc":"Can be personalised for any occasion and any recipient.","category":"mugs"}'>
          <img class="h-48 w-full object-cover" src="coffee-mugs-personalised-1.jpg" alt="Coffee mugs personalised">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Coffee mugs personalised</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Mugs</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Photos, names or messages.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£8</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"plastic-cups-for-birthday-parties-each","title":"Plastic cups for birthday parties  each","price":4,"img":"plastic-cups-for-birthday-parties-each-1.jpg","desc":"Can be personalised for any occasion and any recipient.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="plastic-cups-for-birthday-parties-each-1.jpg" alt="Plastic cups for birthday parties each">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Plastic cups for birthday parties</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Names, colours, themes.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£4</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"straw-glass-cups-with-lid","title":"Straw glass cups with lid","price":5,"img":"straw-glass-cups-with-lid-1.jpg","desc":"Can be personalised for any occasion and any recipient.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="straw-glass-cups-with-lid-1.jpg" alt="Straw glass cups with lid">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Straw glass cups with lid</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Reusable & customisable.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£5</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft overflow-hidden border" data-category="other" data-product='{"id":"personalised-t","title":"Personalised T","price":11,"img":"personalised-t-1.jpg","desc":"Personalised to order.","category":"other"}'>
          <img class="h-48 w-full object-cover" src="personalised-t-1.jpg" alt="Personalised T">
          <div class="p-4">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold text-lg">Personalised T</h3>
              <span class="text-xs px-2 py-0.5 rounded-full border" data-badge>Other</span>
            </div>
            <p class="text-sm text-gray-600 mt-1">Names, numbers, graphics.</p>
            <div class="mt-3 flex items-center justify-between">
              <span class="text-xl font-bold">£11</span>
              <div class="flex gap-2">
                <button class="view-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-gray-50"><i class="fa-regular fa-eye"></i> View</button>
                <button class="add-btn inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus"></i> Add</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- ===== FILTERS ===== -->
    <div class="tab-panel hidden" data-panel="filters">
      <div class="bg-white rounded-2xl p-6 shadow-soft border">
        <h3 class="text-xl font-semibold">Filter products</h3>

        <!-- Chip bar -->
        <div class="mt-3 flex flex-wrap gap-2" id="chipBar" aria-label="Quick category filter">
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="">All</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="flowers">Flowers</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="wall-art">Wall Art</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="mugs">Mugs</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="sweets">Sweet Treats</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="tshirts">T-Shirts</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="accessories">Accessories</button>
          <button class="chip px-3 py-1.5 rounded-full border" data-cat="other">Other</button>
        </div>

        <!-- Form controls -->
        <div class="mt-4 grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
          <label class="block">
            <span class="text-sm">Category</span>
            <select id="categoryFilter" class="mt-1 w-full rounded-lg border px-3 py-2">
              <option value="">All</option>
              <option value="flowers">Flowers</option>
              <option value="wall-art">Wall Art</option>
              <option value="mugs">Mugs</option>
              <option value="tshirts">T-Shirts</option>
              <option value="accessories">Accessories</option>
              <option value="sweets">Sweet Treats</option>
              <option value="other">Other</option>
            </select>
          </label>
          <label class="block">
            <span class="text-sm">Max Price (£)</span>
            <input id="priceFilter" type="number" step="0.01" class="mt-1 w-full rounded-lg border px-3 py-2" placeholder="e.g. 15" />
          </label>
          <div class="flex items-end gap-3">
            <button id="applyFilters" class="px-4 py-2 rounded-xl text-white" style="background: var(--brand);">Apply</button>
            <button id="clearFilters" class="px-4 py-2 rounded-xl border">Clear</button>
            <button id="resetToCollections" class="px-4 py-2 rounded-xl border">Reset to Collections</button>
          </div>
        </div>

        <!-- Results counter -->
        <p class="text-sm text-gray-600 mt-3">
          <span id="filterCount">Showing all items</span>. Filters affect the cards in <strong>Collections</strong>.
        </p>
      </div>
    </div>

    <!-- ===== HTML TABLE ===== -->
    <div class="tab-panel hidden" data-panel="table">
      <div class="bg-white rounded-2xl p-6 border shadow-soft">
        <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3">
          <h3 class="text-xl font-semibold">Product List (enhanced)</h3>
          <div class="flex gap-2">
            <input id="tblSearch" class="rounded-lg border px-3 py-2 w-60" placeholder="Search name, notes, recipient…" />
            <button id="tblExport" class="rounded-lg border px-3 py-2">Export CSV</button>
          </div>
        </div>

        <div class="overflow-auto max-h-[70vh] mt-4">
          <table id="productsTbl" class="w-full text-sm border-collapse">
            <caption class="sr-only">Iris93 products (sortable, filterable, with actions)</caption>
            <thead class="bg-gray-100 sticky top-0 z-10">
              <tr>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="text">Product</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="num">Price (£)</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="num">RRP (£)</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="num">Discount</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="text">Category</th>
                <th class="border px-3 py-2 text-left">Personalisation</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="text">Lead time</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="text">Status</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="num">Min order</th>
                <th class="border px-3 py-2 text-left th-sortable" data-sort="text">Occasion / Recipient</th>
                <th class="border px-3 py-2 text-left">Variants</th>
                <th class="border px-3 py-2 text-left">Notes</th>
                <th class="border px-3 py-2 text-left">Action</th>
              </tr>
            </thead>
            <tbody id="tblBody"></tbody>
            <tfoot class="bg-gray-50">
              <tr>
                <td class="border px-3 py-2 font-medium" colspan="13">
                  <span id="tblSummary">0 items • Avg £0.00</span>
                </td>
              </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ===== PRODUCT MODAL (with gallery) ===== -->
<div id="productModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4">
  <div class="bg-white max-w-3xl w-full rounded-2xl overflow-hidden shadow-soft">
    <div class="flex items-center justify-between px-5 py-4 border-b">
      <h3 id="modalTitle" class="text-xl font-semibold"></h3>
      <button id="modalClose" class="text-gray-500 hover:text-gray-700"><i class="fa-solid fa-xmark text-xl"></i></button>
    </div>

    <!-- Carousel area -->
    <div class="relative">
      <img id="modalImg" class="w-full h-80 object-cover" alt="">
      <button class="carousel-btn left" id="prevImg" aria-label="Previous"><i class="fa-solid fa-chevron-left"></i></button>
      <button class="carousel-btn right" id="nextImg" aria-label="Next"><i class="fa-solid fa-chevron-right"></i></button>
    </div>

    <div class="p-5">
      <div id="thumbs" class="flex flex-wrap gap-2 mb-4"></div>
      <p id="modalDesc" class="text-gray-700"></p>
      <div class="mt-4 text-2xl font-bold" id="modalPrice"></div>
      <div class="mt-5 flex flex-wrap gap-3">
        <button id="modalAdd" class="px-4 py-2 rounded-xl text-white" style="background: var(--accent);"><i class="fa-solid fa-cart-plus mr-2"></i>Add to Cart</button>
        <a id="modalBuy" href="#" target="_blank" rel="noopener" class="px-4 py-2 rounded-xl border inline-flex items-center gap-2">
          <i class="fa-solid fa-bolt"></i> Buy Now
        </a>
      </div>
    </div>
  </div>
</div>

<!-- ===== CART DRAWER ===== -->
<aside id="cartDrawer" class="fixed top-0 right-0 h-full w-[90%] sm:w-[420px] bg-white shadow-2xl translate-x-full transition-transform duration-300 z-50">
  <div class="h-full flex flex-col">
    <div class="p-4 border-b flex items-center justify-between">
      <h3 class="text-lg font-semibold"><i class="fa-solid fa-basket-shopping mr-2"></i>Your Cart</h3>
      <button id="cartClose" class="text-gray-500 hover:text-gray-700"><i class="fa-solid fa-xmark text-xl"></i></button>
    </div>
    <div id="cartItems" class="flex-1 overflow-auto p-4 space-y-3"></div>
    <div class="p-4 border-t">
      <div class="flex items-center justify-between font-semibold">
        <span>Subtotal</span>
        <span id="cartSubtotal">£0.00</span>
      </div>
      <button id="checkoutBtn" class="mt-4 w-full px-4 py-2 rounded-xl text-white" style="background: var(--brand);">Checkout</button>
    </div>
  </div>
</aside>

<!-- ===== FOOTER ===== -->
<footer class="mt-14 border-t">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex flex-col sm:flex-row items-center justify-between gap-3 text-sm">
    <p>© <span id="year"></span> Iris93 • Personalised Gifts</p>
    <p>
      <a class="underline" href="https://github.com/simcamelia/Responsiveprojectfinal/tree/main" target="_blank" rel="noopener">GitHub repo</a>
      &nbsp;|&nbsp;
      <a class="underline" href="https://responsivecs.netlify.app" target="_blank" rel="noopener">Hosted on Netlify</a>
    </p>
  </div>
</footer>

<!-- ===== SCRIPTS ===== -->
<script>
  document.getElementById('year').textContent = new Date().getFullYear();

  // Tabs
  const tabButtons = document.querySelectorAll('.tab-btn');
  const tabPanels = document.querySelectorAll('.tab-panel');
  tabButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const target = btn.dataset.tab;
      tabButtons.forEach(b => b.setAttribute('aria-selected', String(b === btn)));
      tabPanels.forEach(p => p.classList.toggle('hidden', p.dataset.panel !== target));
      location.hash = target;
    });
  });
  const hash = location.hash.replace('#','');
  if(hash){
    const targetBtn = Array.from(tabButtons).find(b => b.dataset.tab === hash);
    if(targetBtn) targetBtn.click();
  }

  // Product index (for table + modal)
  function getAllProducts(){
    return Array.from(document.querySelectorAll('[data-product]'))
      .map(c => JSON.parse(c.dataset.product));
  }
  const productsIndex = {};
  getAllProducts().forEach(p => { productsIndex[p.id] = p; });

  // Modal + Gallery
  const modal = document.getElementById('productModal');
  const modalClose = document.getElementById('modalClose');
  const modalTitle = document.getElementById('modalTitle');
  const modalImg = document.getElementById('modalImg');
  const modalDesc = document.getElementById('modalDesc');
  const modalPrice = document.getElementById('modalPrice');
  const modalAdd = document.getElementById('modalAdd');
  const modalBuy = document.getElementById('modalBuy');
  const thumbs = document.getElementById('thumbs');
  const prevImg = document.getElementById('prevImg');
  const nextImg = document.getElementById('nextImg');

  let currentProduct = null;
  let gallery = [];
  let galleryIndex = 0;

  function showImageAt(i){
    if (!gallery.length) return;
    galleryIndex = (i + gallery.length) % gallery.length;
    modalImg.src = gallery[galleryIndex];
    Array.from(thumbs.children).forEach((t,idx) => t.classList.toggle('active', idx===galleryIndex));
  }
  function buildThumbs(){
    thumbs.innerHTML = '';
    gallery.forEach((src, idx) => {
      const im = document.createElement('img');
      im.src = src; im.alt = currentProduct.title + ' ' + (idx+1);
      im.className = 'thumb' + (idx===galleryIndex ? ' active' : '');
      im.addEventListener('click', () => showImageAt(idx));
      thumbs.appendChild(im);
    });
  }
  function discoverGallery(firstSrc){
    const out = [firstSrc];
    const m = firstSrc.match(/^(.*?)(-\d+)?(\.[a-zA-Z0-9]+)$/);
    if (!m) return out;
    const base = m[1];
    const ext  = m[3];
    for(let n=2; n<=8; n++){
      const candidate = `${base}-${n}${ext}`;
      const img = new Image();
      img.onload = () => {
        if (!out.includes(candidate)) {
          out.push(candidate);
          gallery = out.slice();
          buildThumbs();
        }
      };
      img.onerror = () => {};
      img.src = candidate;
    }
    return out;
  }
  function openModal(product){
    currentProduct = product;
    modalTitle.textContent = product.title;
    modalDesc.textContent = product.desc || '';
    modalPrice.textContent = product.price > 0 ? '£' + product.price.toFixed(2) : '';
    modalBuy.href = 'https://wa.me/447000000000?text=' + encodeURIComponent("Hi Iris93! I'd like to buy: " + product.title + (product.price>0 ? ' (£' + product.price.toFixed(2) + ')' : '') );
    gallery = discoverGallery(product.img);
    galleryIndex = 0;
    modalImg.src = gallery[0];
    buildThumbs();
    modal.classList.remove('hidden'); modal.classList.add('flex');
  }
  function closeModal(){ modal.classList.add('hidden'); modal.classList.remove('flex'); currentProduct = null; gallery = []; }
  modalClose.addEventListener('click', closeModal);
  modal.addEventListener('click', e => { if(e.target === modal) closeModal(); });
  prevImg.addEventListener('click', () => showImageAt(galleryIndex - 1));
  nextImg.addEventListener('click', () => showImageAt(galleryIndex + 1));

  document.querySelectorAll('.view-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const card = btn.closest('[data-product]');
      const product = JSON.parse(card.dataset.product);
      openModal(product);
    });
  });

  // Cart
  const cartBtn = document.getElementById('cartBtn');
  const cartDrawer = document.getElementById('cartDrawer');
  const cartClose = document.getElementById('cartClose');
  const cartItems = document.getElementById('cartItems');
  const cartSubtotal = document.getElementById('cartSubtotal');
  const cartCount = document.getElementById('cartCount');
  const checkoutBtn = document.getElementById('checkoutBtn');

  let cart = [];
  function openCart(){ cartDrawer.style.transform = 'translateX(0)'; }
  function closeCart(){ cartDrawer.style.transform = 'translateX(100%)'; }
  cartBtn.addEventListener('click', openCart);
  cartClose.addEventListener('click', closeCart);

  function addToCart(p){
    const existing = cart.find(i => i.id === p.id);
    if(existing){ existing.qty += 1; } else { cart.push(Object.assign({ qty:1 }, p)); }
    renderCart();
    cartBtn.classList.add('ring-2','ring-amber-400');
    setTimeout(() => cartBtn.classList.remove('ring-2','ring-amber-400'), 400);
  }
  function removeFromCart(id){ cart = cart.filter(i => i.id !== id); renderCart(); }
  function changeQty(id, delta){
    const item = cart.find(i => i.id === id);
    if(!item) return;
    item.qty += delta;
    if(item.qty <= 0) removeFromCart(id);
    renderCart();
  }
  function renderCart(){
    cartItems.innerHTML = '';
    let subtotal = 0;
    cart.forEach(item => {
      subtotal += (item.price || 0) * item.qty;
      const row = document.createElement('div');
      row.className = 'flex gap-3 items-center border rounded-xl p-2';
      row.innerHTML = ''
        + '<img src="' + item.img + '" alt="' + item.title + '" class="w-16 h-16 object-cover rounded-lg">'
        + '<div class="flex-1">'
        +   '<div class="font-semibold">' + item.title + '</div>'
        +   '<div class="text-sm text-gray-600">£' + (item.price || 0).toFixed(2) + ' × ' + item.qty + '</div>'
        +   '<div class="mt-1 flex items-center gap-2">'
        +     '<button class="px-2 py-1 border rounded-lg qty-dec">−</button>'
        +     '<button class="px-2 py-1 border rounded-lg qty-inc">+</button>'
        +     '<button class="px-2 py-1 border rounded-lg text-rose-600 remove">Remove</button>'
        +   '</div>'
        + '</div>';
      row.getElementsByClassName('qty-dec')[0].addEventListener('click', () => changeQty(item.id, -1));
      row.getElementsByClassName('qty-inc')[0].addEventListener('click', () => changeQty(item.id, +1));
      row.getElementsByClassName('remove')[0].addEventListener('click', () => removeFromCart(item.id));
      cartItems.appendChild(row);
    });
    cartSubtotal.textContent = '£' + subtotal.toFixed(2);
    cartCount.textContent = cart.reduce((a,b) => a+b.qty, 0);
  }
  document.getElementById('cardsGrid').addEventListener('click', e => {
    const add = e.target.closest('.add-btn');
    if (!add) return;
    const card = add.closest('[data-product]');
    addToCart(JSON.parse(card.dataset.product));
  });

  checkoutBtn.addEventListener('click', () => {
    if(cart.length === 0){ alert('Your cart is empty.'); return; }
    const summary = cart.map(i => i.title + ' x' + i.qty + ' (£' + ((i.price||0)*i.qty).toFixed(2) + ')').join('%0A');
    const total = cart.reduce((a,b) => a+(b.price||0)*b.qty, 0);
    const msg = 'Hi Iris93!%0A%0AI\'d like to order:%0A' + summary + '%0A%0ATotal: £' + total.toFixed(2) + '.%0AName:%0ADelivery address:%0ANotes:';
    window.open('https://wa.me/447000000000?text=' + msg, '_blank', 'noopener');
  });

  // Filters
  const categoryFilter = document.getElementById('categoryFilter');
  const priceFilter = document.getElementById('priceFilter');
  const applyFilters = document.getElementById('applyFilters');
  const clearFilters = document.getElementById('clearFilters');

  function runFilters(){
    const cat = categoryFilter ? categoryFilter.value : '';
    const maxPrice = priceFilter ? parseFloat(priceFilter.value || '0') : 0;
    document.querySelectorAll('[data-product]').forEach(card => {
      const data = JSON.parse(card.dataset.product);
      const byCat = !cat || (data.category === cat);
      const byPrice = !maxPrice || ((data.price || 0) <= maxPrice);
      card.classList.toggle('hidden', !(byCat && byPrice));
    });
    const collectionsBtn = document.querySelector('[data-tab="collections"]');
    if (collectionsBtn) collectionsBtn.click();
    updateFilterCount();
  }
  if (applyFilters) applyFilters.addEventListener('click', runFilters);
  if (clearFilters) clearFilters.addEventListener('click', () => { categoryFilter.value = ''; priceFilter.value = ''; runFilters(); });

  const chipBar = document.getElementById('chipBar');
  const filterCount = document.getElementById('filterCount');
  const resetToCollections = document.getElementById('resetToCollections');

  function highlightChip(activeCat){
    document.querySelectorAll('#chipBar .chip').forEach(ch => {
      const on = ch.dataset.cat === (activeCat || '');
      ch.classList.toggle('bg-purple-50', on);
      ch.classList.toggle('border-purple-300', on);
      ch.classList.toggle('text-purple-700', on);
    });
  }
  function updateFilterCount(){
    const cards = Array.from(document.querySelectorAll('[data-product]'));
    const visible = cards.filter(c => !c.classList.contains('hidden')).length;
    const total = cards.length;
    filterCount.textContent = visible === total ? 'Showing all items' : `Showing ${visible} of ${total} items`;
  }
  function runFiltersPublic(){
    if (typeof runFilters === 'function') runFilters();
    else updateFilterCount();
  }
  if (chipBar){
    chipBar.addEventListener('click', (e) => {
      const btn = e.target.closest('.chip');
      if (!btn) return;
      const cat = btn.dataset.cat || '';
      if (categoryFilter) categoryFilter.value = cat;
      highlightChip(cat);
      runFiltersPublic();
      const collectionsBtn = document.querySelector('[data-tab="collections"]');
      if (collectionsBtn) collectionsBtn.click();
    });
  }
  if (resetToCollections){
    resetToCollections.addEventListener('click', () => {
      if (categoryFilter) categoryFilter.value = '';
      if (priceFilter) priceFilter.value = '';
      highlightChip('');
      document.querySelectorAll('[data-product]').forEach(card => card.classList.remove('hidden'));
      updateFilterCount();
      const collectionsBtn = document.querySelector('[data-tab="collections"]');
      if (collectionsBtn) collectionsBtn.click();
    });
  }
  highlightChip('');
  updateFilterCount();

  // Table build & interactions
  const productMeta = {
    "funeral-flowers": { personalise:"Yes", lead:"2–3 days", status:"Made-to-order", min:1, occasion:"Sympathy", recipient:"Family/Friends", variants:["#a855f7","#ef4444","#f59e0b"], rrp:75, notes:"Soap or natural flowers." },
    "easter-basket": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:1, occasion:"Easter/Xmas", recipient:"Kids/Adults", variants:["#10b981","#f59e0b","#3b82f6"], rrp:18, notes:"Theme customisable." },
    "mother-s-day-wall-art": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:1, occasion:"Mother’s Day", recipient:"Mum/Grandma", variants:["#ef4444","#f59e0b","#0ea5e9"], rrp:12, notes:"Digital or printed." },
    "international-women-s-day": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:1, occasion:"Women’s Day", recipient:"Her", variants:["#a855f7","#ec4899","#fbbf24"], rrp:12, notes:"Custom names/messages." },
    "mother-s-day-keyrings": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:5, occasion:"Mother’s/Father’s Day", recipient:"Teachers/Parents", variants:["#ef4444","#22c55e","#3b82f6"], rrp:2, notes:"Bulk pricing available." },
    "personalised-metal-water-bottles": { personalise:"Yes", lead:"2–3 days", status:"In stock", min:1, occasion:"School/Sports", recipient:"Kids/Adults", variants:["#0ea5e9","#111827","#f59e0b"], rrp:16, notes:"Dishwasher-safe (top rack)." },
    "martis-martisor": { personalise:"Yes", lead:"1 day", status:"In stock", min:2, occasion:"Mărțișor", recipient:"Friends/Colleagues", variants:["#ef4444","#ffffff"], rrp:3, notes:"Traditional charm." },
    "martisor-and": { personalise:"Yes", lead:"1 day", status:"In stock", min:2, occasion:"Mărțișor", recipient:"Kids/Adults", variants:["#ef4444","#f59e0b","#14b8a6"], rrp:2, notes:"Mix & match charms." },
    "sweet-treats-boxes": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:4, occasion:"Birthdays", recipient:"Kids/Party guests", variants:["#f59e0b","#22c55e","#eab308"], rrp:4, notes:"Contents vary; nut-free on request." },
    "soap-roses-boxes": { personalise:"Yes", lead:"2 days", status:"In stock", min:1, occasion:"Anniversary", recipient:"Partner", variants:["#ef4444","#f472b6","#14b8a6"], rrp:14, notes:"Long-lasting soap petals." },
    "soap-flowers-bouquet": { personalise:"Yes", lead:"2–3 days", status:"Made-to-order", min:1, occasion:"Birthday/Anniversary", recipient:"Her", variants:["#a855f7","#f59e0b","#10b981"], rrp:18, notes:"Custom sizes available." },
    "coffee-mugs-personalised": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:1, occasion:"Any", recipient:"Anyone", variants:["#111827","#3b82f6","#ef4444"], rrp:10, notes:"Photo/text prints." },
    "plastic-cups-for-birthday-parties-each": { personalise:"Yes", lead:"1 day", status:"In stock", min:6, occasion:"Birthday", recipient:"Kids", variants:["#3b82f6","#f59e0b","#22c55e"], rrp:5, notes:"Reusable party cups." },
    "straw-glass-cups-with-lid": { personalise:"Yes", lead:"1–2 days", status:"In stock", min:1, occasion:"Everyday", recipient:"Teen/Adult", variants:["#111827","#10b981","#f59e0b"], rrp:6, notes:"Glass straw included." },
    "personalised-t": { personalise:"Yes", lead:"2–3 days", status:"Made-to-order", min:1, occasion:"Any", recipient:"Anyone", variants:["#111827","#ef4444","#22c55e"], rrp:14, notes:"Sizes for kids & adults." }
  };

  const tblBody = document.getElementById('tblBody');
  function renderTable(){
    const cards = Array.from(document.querySelectorAll('[data-product]'));
    tblBody.innerHTML = '';
    cards.forEach(card => {
      const data = JSON.parse(card.dataset.product);
      const meta = productMeta[data.id] || {};
      const price = Number(data.price || 0);
      const rrp = Number(meta.rrp || 0);
      const discount = (rrp && price && rrp > price) ? Math.round((100*(rrp-price))/rrp) + '%' : '—';
      let variantsHTML = '—';
      if (meta.variants && meta.variants.length){
        variantsHTML = meta.variants.map(c => '<span class="swatch" title="'+c+'" style="background:'+c+'"></span>').join('');
      }
      const catBadge = '<span class="text-xs px-2 py-0.5 rounded-full border">'+ (data.category || 'other') +'</span>';

      const tr = document.createElement('tr');
      tr.dataset.id = data.id;
      tr.innerHTML = `
        <td class="border px-3 py-2">${data.title || ''}</td>
        <td class="border px-3 py-2" data-price="${price}">£${price ? price.toFixed(2) : '—'}</td>
        <td class="border px-3 py-2" data-rrp="${rrp}">${rrp ? '£'+rrp.toFixed(2) : '—'}</td>
        <td class="border px-3 py-2">${discount}</td>
        <td class="border px-3 py-2">${catBadge}</td>
        <td class="border px-3 py-2">${meta.personalise || 'Yes'}</td>
        <td class="border px-3 py-2">${meta.lead || '1–3 days'}</td>
        <td class="border px-3 py-2">${meta.status || 'In stock'}</td>
        <td class="border px-3 py-2" data-min="${meta.min || 1}">${meta.min || 1}</td>
        <td class="border px-3 py-2">${(meta.occasion || 'Any') + ' / ' + (meta.recipient || 'Anyone')}</td>
        <td class="border px-3 py-2">${variantsHTML}</td>
        <td class="border px-3 py-2">${meta.notes || (data.desc || '—')}</td>
        <td class="border px-3 py-2"><button class="view-row underline text-indigo-700">View</button></td>
      `;
      tblBody.appendChild(tr);
    });
    updateSummary();
  }

  // Table interactions: search, sort, export, view
  const tbl = document.getElementById('productsTbl');
  const search = document.getElementById('tblSearch');
  const summary = document.getElementById('tblSummary');
  const exportBtn = document.getElementById('tblExport');

  tbl.querySelectorAll('thead th[data-sort]').forEach((th, idx) => {
    let dir = 1;
    th.addEventListener('click', () => {
      const type = th.dataset.sort;
      const rows = Array.from(tblBody.querySelectorAll('tr'));
      rows.sort((a,b) => {
        const A = a.children[idx].textContent.trim();
        const B = b.children[idx].textContent.trim();
        if (type === 'num') {
          const aNum = parseFloat(a.children[idx].dataset.price || a.children[idx].dataset.rrp || a.children[idx].dataset.min || A.replace(/[^\d.]/g,'')) || 0;
          const bNum = parseFloat(b.children[idx].dataset.price || b.children[idx].dataset.rrp || b.children[idx].dataset.min || B.replace(/[^\d.]/g,'')) || 0;
          return (aNum - bNum) * dir;
        }
        return A.localeCompare(B) * dir;
      });
      dir *= -1;
      rows.forEach(r => tblBody.appendChild(r));
      updateSummary();
    });
  });

  function filterRows() {
    const q = (search.value || '').toLowerCase();
    tblBody.querySelectorAll('tr').forEach(tr => {
      const text = tr.textContent.toLowerCase();
      tr.classList.toggle('hidden', !text.includes(q));
    });
    updateSummary();
  }
  if (search) search.addEventListener('input', filterRows);

  function updateSummary() {
    const visible = Array.from(tblBody.querySelectorAll('tr')).filter(tr => !tr.classList.contains('hidden'));
    const prices = visible.map(tr => {
      const priceCell = tr.querySelector('[data-price]');
      return priceCell ? parseFloat(priceCell.dataset.price || '0') : 0;
    });
    const count = visible.length;
    const avg = prices.length ? (prices.reduce((a,b)=>a+b,0)/prices.length) : 0;
    summary.textContent = `${count} item${count!==1?'s':''} • Avg £${avg.toFixed(2)}`;
  }

  function exportCSV() {
    const visible = Array.from(tblBody.querySelectorAll('tr')).filter(tr => !tr.classList.contains('hidden'));
    const head = Array.from(tbl.querySelectorAll('thead th')).map(th => th.textContent.trim());
    const rows = visible.map(tr => Array.from(tr.children).map(td => `"${td.textContent.replace(/"/g,'""').trim()}"`));
    const csv = [head, ...rows].map(r => r.join(',')).join('\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'iris93-products.csv';
    a.click();
    URL.revokeObjectURL(a.href);
  }
  if (exportBtn) exportBtn.addEventListener('click', exportCSV);

  // Table -> Modal (robust via index)
  tblBody.addEventListener('click', (e) => {
    const btn = e.target.closest('button.view-row');
    if (!btn) return;
    const id = btn.closest('tr').dataset.id;
    const product = productsIndex[id];
    if (!product) return alert('Product details not found.');
    openModal(product);
  });

  // Initial render
  renderTable();
</script>

<!-- Facebook SDK + fallback detector -->
<div id="fb-root"></div>
<script async defer crossorigin="anonymous"
  src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v19.0"></script>
<script>
  (function () {
    function tryFallback() {
      var wrapper = document.getElementById('fb-wrapper');
      var fallback = document.getElementById('fb-fallback');
      if (!wrapper || !fallback) return;
      var iframe = wrapper.querySelector('iframe');
      var blocked = !iframe || iframe.clientHeight < 100;
      if (blocked) {
        wrapper.classList.add('hidden');
        fallback.classList.remove('hidden');
      }
    }
    window.addEventListener('load', function () {
      setTimeout(tryFallback, 1800);
    });
  })();
</script>

</body>
</html>
